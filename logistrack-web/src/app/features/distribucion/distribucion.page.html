<section class="p-4 space-y-4" *ngIf="vm$ | async as vm">
  <h2 class="text-xl font-semibold">Distribución</h2>

  <app-filters-bar
    [fields]="fields"
    [value]="{
      estado: vm.q.estado,
      chofer_id: vm.q.chofer_id,
      desde: vm.q.desde,
      hasta: vm.q.hasta,
    }"
    (change)="onFilters($event)"
    (cleared)="onCleared()"
  />

  <app-error-state
    *ngIf="vm.error"
    [message]="'No se pudo cargar la distribución.'"
    (retry)="onFilters(vm.q)"
  ></app-error-state>

  <app-empty-state
    *ngIf="!vm.error && !vm.loading && vm.count === 0"
    title="Sin órdenes"
  ></app-empty-state>

  <app-table
    *ngIf="!vm.error && vm.count > 0"
    [columns]="columns"
    [data]="vm.data"
    [loading]="vm.loading"
    [length]="vm.count"
    [pageIndex]="vm.q.page - 1"
    (page)="onPage($event, vm.q)"
  >
  </app-table>

  <p class="text-xs text-gray-500">
    Ordenado por <code>{{ vm.q.ordering }}</code>
  </p>
</section>
